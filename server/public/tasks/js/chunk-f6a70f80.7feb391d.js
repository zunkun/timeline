(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f6a70f80"],{"0894":function(t,e,o){},"0e85":function(t,e,o){"use strict";var n=o("0894"),s=o.n(n);s.a},"32a6":function(t,e,o){var n=o("241e"),s=o("c3a1");o("ce7e")("keys",function(){return function(t){return s(n(t))}})},3703:function(t,e,o){},"469f":function(t,e,o){o("6c1c"),o("1654"),t.exports=o("7d7b")},"4a2b":function(t,e,o){"use strict";var n=o("75c0"),s=o.n(n);s.a},"5d73":function(t,e,o){t.exports=o("469f")},"75c0":function(t,e,o){},"75cf":function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"todos"}},[o("el-tabs",{model:{value:t.showTab,callback:function(e){t.showTab=e},expression:"showTab"}},[o("el-tab-pane",{attrs:{label:"事项列表",name:"summary"}},[o("TodoListsSummary")],1),t._l(t.$store.state.constants.todoTypes,function(e,n){return o("el-tab-pane",{key:"todoTypePanel-"+n,attrs:{label:e.name,name:e.type,lazy:!0}},[o("TodoLists",{attrs:{"todo-type":e,type:t.showTab}})],1)})],2)],1)},s=[],a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-row",t._l(t.$store.state.constants.todoTypes,function(e,n){return o("el-col",{key:"todoType-"+n,staticClass:"todo-p",attrs:{span:12}},[o("div",{staticClass:"todo-title"},[o("span",{staticClass:"title-c"},[t._v(t._s(e.name))])]),o("TodoInputLists",{attrs:{todolists:t.todos[e.type],type:e.type}})],1)}),1)],1)},i=[],c=o("5d73"),r=o.n(c),u=(o("96cf"),o("3b8d")),d=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"todoinputlists"}},[o("el-row",[o("el-col",{attrs:{span:24}},[o("draggable",{attrs:{group:"todos",move:t.moveTodo,"ghost-class":"ghost"},on:{start:function(e){t.drag=!0},end:function(e){t.drag=!1},change:t.changeTodo},model:{value:t.todos,callback:function(e){t.todos=e},expression:"todos"}},t._l(t.todos,function(e,n){return o("div",{key:t.type+"-"+n,staticClass:"todo-f"},[o("div",{staticClass:"todo-item1"},[o("el-checkbox",{staticClass:"t-check",staticStyle:{float:"left"},attrs:{disabled:!e.id||!e.text},on:{change:function(o){return t.checkTodo(e)}},model:{value:e.checked,callback:function(o){t.$set(e,"checked",o)},expression:"todo.checked"}})],1),o("div",{staticClass:"todo-item2"},[o("el-input",{class:{"todo-input":!0,"text-checked":e.checked},attrs:{placeholder:"输入事项"},on:{blur:function(o){return t.saveTodo(e,n)}},nativeOn:{keyup:function(o){return!o.type.indexOf("key")&&t._k(o.keyCode,"enter",13,o.key,"Enter")?null:t.saveTodo(e,n)}},model:{value:e.text,callback:function(o){t.$set(e,"text",o)},expression:"todo.text"}})],1),o("div",{directives:[{name:"show",rawName:"v-show",value:e.id,expression:"todo.id"}],staticClass:"icon-parent todo-item3"},[o("el-tooltip",{attrs:{effect:"light",content:"important"==e.type?"调整该项为普通项目":"调整该项为重要项目",placement:"top-end"}},[o("i",{staticClass:"el-icon-tl-exchange i-son",on:{click:function(o){return t.changeType(e,n)}}})]),o("el-tooltip",{attrs:{effect:"light",content:"删除该事项",placement:"top-end"}},[o("i",{staticClass:"el-icon-delete i-son",on:{click:function(o){return t.deleteTodo(e,n)}}})])],1),o("div",{staticClass:"clear"})])}),0)],1)],1)],1)},l=[],p=o("a4bb"),h=o.n(p),f=o("f499"),m=o.n(f),y=o("1980"),v=o.n(y),T={name:"TodoLists",props:["todolists","type"],components:{draggable:v.a},data:function(){return{baseUrl:"/tasks/api/todos",todos:[]}},methods:{getTodos:function(t){var e=this,o="".concat(this.baseUrl,"/?type=").concat(t);fetch(o).then(function(t){if(t.ok)return t.json();throw"获取ToDo 列表失败"}).then(function(t){t&&(e.todos=t||[])}).catch(function(t){return console.log(t)})},saveTodo:function(t,e){var o=this,n="POST";if(!t.text||!t.text.trim()){if(!t.id)return;return this.deleteTodo(t,e)}var s="".concat(this.baseUrl,"/");t.id&&(s="".concat(s).concat(t.id),n="PUT"),fetch(s,{method:n,body:m()(t),headers:{"content-type":"application/json"}}).then(function(t){return t.json()}).then(function(t){t.id&&(o.todos[e]=t,o.newTodo(t.type))})},deleteTodo:function(t,e){var o=this,n="".concat(this.baseUrl,"/").concat(t.id);fetch(n,{method:"DELETE",headers:{"content-type":"application/json"}}).then(function(t){t.ok&&o.todos.splice(e,1)})},newTodo:function(){var t=[{checked:!1,text:"",type:this.type,sequence:0}];this.todos=t.concat(this.todos)},updateTodoInfo:function(t,e){var o="/tasks/api/todos/".concat(e);fetch(o,{method:"PUT",body:m()(t),headers:{"content-type":"application/json"}})},moveTodo:function(t){var e=t.draggedContext;if(!e.element||!e.element.id)return!1},changeTodo:function(t){var e=h()(t)[0],o=t[e].element;if(!o.id)return!1;if("added"===e){var n="important"===o.type?"common":"important";return this.updateTodoInfo({type:n},o.id)}},checkTodo:function(t){this.updateTodoInfo({checked:t.checked},t.id)},changeType:function(t,e){this.updateTodoInfo({type:"important"===t.type?"common":"important"},t.id),this.todos.splice(e,1)},init:function(){this.todos=this.todolists,this.newTodo()}},created:function(){this.init()},watch:{todolists:function(t,e){this.todos=t||[],this.newTodo(this.type)}}},b=T,g=(o("0e85"),o("2877")),k=Object(g["a"])(b,d,l,!1,null,null,null),w=k.exports,x={name:"TodoListsSummary",components:{TodoInputLists:w},data:function(){return{baseUrl:"/tasks/api/todos",types:[{type:"important",name:"重要事项"},{type:"common",name:"普通事项"}],todos:{important:[],common:[]},drag:!1}},methods:{getTodos:function(t){var e=this,o="".concat(this.baseUrl,"/?type=").concat(t);fetch(o).then(function(t){if(t.ok)return t.json();throw"获取ToDo 列表失败"}).then(function(o){o&&(e.todos[t]=o.rows||[])}).catch(function(t){return console.log(t)})},initTodos:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){var e,o,n,s,a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:for(e=!0,o=!1,n=void 0,t.prev=3,s=r()(this.$store.state.constants.todoTypes);!(e=(a=s.next()).done);e=!0)i=a.value,this.getTodos(i.type);t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](3),o=!0,n=t.t0;case 11:t.prev=11,t.prev=12,e||null==s.return||s.return();case 14:if(t.prev=14,!o){t.next=17;break}throw n;case 17:return t.finish(14);case 18:return t.finish(11);case 19:case"end":return t.stop()}},t,this,[[3,7,11,19],[12,,14,18]])}));function e(){return t.apply(this,arguments)}return e}()},created:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.initTodos();case 2:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},j=x,_=Object(g["a"])(j,a,i,!1,null,null,null),O=_.exports,C=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"todolists"}},[o("div",[t._v("\n    "+t._s(t.todoType.name)+"\n  ")]),o("TodoInputLists",{attrs:{todolists:t.todos,type:t.showType}}),t.count>t.limit?o("el-pagination",{staticClass:"pagination-z",attrs:{background:"",layout:"prev, pager, next","page-size":t.limit,total:t.count},on:{"current-change":t.changeData}}):t._e()],1)},L=[],U={name:"TodoLists",props:["todoType","type"],components:{TodoInputLists:w},data:function(){return{baseUrl:"/tasks/api/todos",todos:[],page:1,limit:10,count:0,showType:this.type}},methods:{getTodos:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(e){var o,n=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return o="".concat(this.baseUrl,"/?limit=").concat(this.limit,"&page=").concat(this.page),e&&(o="".concat(o,"&type=").concat(e)),t.abrupt("return",fetch(o).then(function(t){if(t.ok)return t.json();throw"获取ToDo 列表失败"}).then(function(t){if(t)return n.count=t.count||0,n.todos=t.rows||[],n.todos}).catch(function(t){return console.log(t)}));case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),changeData:function(t){this.page=t,this.getTodos(this.todoType.type)}},created:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.getTodos(this.todoType.type);case 1:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),watch:{type:function(t,e){t!==e&&this.getTodos(t)}}},E=U,I=(o("ede3"),Object(g["a"])(E,C,L,!1,null,null,null)),$=I.exports,R={name:"Todos",components:{TodoListsSummary:O,TodoLists:$},data:function(){return{baseUrl:"/tasks/api/todos",showTab:"summary"}}},D=R,S=(o("4a2b"),Object(g["a"])(D,n,s,!1,null,null,null));e["default"]=S.exports},"7d7b":function(t,e,o){var n=o("e4ae"),s=o("7cd6");t.exports=o("584a").getIterator=function(t){var e=s(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return n(e.call(t))}},"8aae":function(t,e,o){o("32a6"),t.exports=o("584a").Object.keys},a4bb:function(t,e,o){t.exports=o("8aae")},ce7e:function(t,e,o){var n=o("63b6"),s=o("584a"),a=o("294c");t.exports=function(t,e){var o=(s.Object||{})[t]||Object[t],i={};i[t]=e(o),n(n.S+n.F*a(function(){o(1)}),"Object",i)}},ede3:function(t,e,o){"use strict";var n=o("3703"),s=o.n(n);s.a}}]);
//# sourceMappingURL=chunk-f6a70f80.7feb391d.js.map